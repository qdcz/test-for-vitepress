<!DOCTYPE html>
<html lang="en-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1ã€åŒè¡Œå¯¹æ¯” | æ¾œæ¼¾</title>
    <meta name="description" content="å¹¿å¤©ä¸‹ä¹‹å¹¿,æ·±å¤©ä¸‹ä¹‹æ·±">
    <link rel="stylesheet" href="/assets/style.49f07aca.css">
    <link rel="modulepreload" href="/assets/Home.83738dfc.js">
    <link rel="modulepreload" href="/assets/app.f3070ad9.js">
    <link rel="modulepreload" href="/assets/environmentConstruction_nginx.md.f2832f95.lean.js">
    
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <meta name="keywords" content="æ¾œæ¼¾">
  <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.css">
  <script src="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.js"></script>
  <script src="https://lib.baomitu.com/axios/0.21.1/axios.js"></script>
  <meta name="twitter:title" content="1ã€åŒè¡Œå¯¹æ¯” | æ¾œæ¼¾">
  <meta property="og:title" content="1ã€åŒè¡Œå¯¹æ¯” | æ¾œæ¼¾">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-d186b2c2><div class="sidebar-button" data-v-d186b2c2><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="æ¾œæ¼¾, back to home" data-v-d186b2c2 data-v-34a93bc8><img class="logo" src="/logo2.jpg" alt="Logo" data-v-34a93bc8> æ¾œæ¼¾</a><div class="flex-grow" data-v-d186b2c2></div><div class="nav" data-v-d186b2c2><nav class="nav-links" data-v-d186b2c2 data-v-30b7e073><!--[--><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/" data-v-711da5ba>ğŸ  é¦–é¡µ <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/home/home" data-v-711da5ba>ç ä¸Šè¡ŒåŠ¨ <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/IDEShortcutKey/WebStorm" data-v-711da5ba>ç¼–è¾‘å™¨å¿«æ·é”® <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item active" href="/environmentConstruction/index" data-v-711da5ba>ç¯å¢ƒæ­å»º <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/windowSystem/index" data-v-711da5ba>window <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/service/Linux/index" data-v-711da5ba>linux <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/about/index" data-v-711da5ba>ğŸ”¨å…³äº <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/concat/index" data-v-711da5ba>ğŸ‘«å‹æƒ…é“¾æ¥ <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/temporary/index" data-v-711da5ba>ä¸´æ—¶å­˜å‚¨ <!----></a></div></div><!--]--><!----><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item isExternal" href="https://github.com/qdcz" target="_blank" rel="noopener noreferrer" data-v-711da5ba>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-711da5ba><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-7e9d9da8><nav class="nav-links nav" data-v-7e9d9da8 data-v-30b7e073><!--[--><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/" data-v-711da5ba>ğŸ  é¦–é¡µ <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/home/home" data-v-711da5ba>ç ä¸Šè¡ŒåŠ¨ <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/IDEShortcutKey/WebStorm" data-v-711da5ba>ç¼–è¾‘å™¨å¿«æ·é”® <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item active" href="/environmentConstruction/index" data-v-711da5ba>ç¯å¢ƒæ­å»º <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/windowSystem/index" data-v-711da5ba>window <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/service/Linux/index" data-v-711da5ba>linux <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/about/index" data-v-711da5ba>ğŸ”¨å…³äº <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/concat/index" data-v-711da5ba>ğŸ‘«å‹æƒ…é“¾æ¥ <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/temporary/index" data-v-711da5ba>ä¸´æ—¶å­˜å‚¨ <!----></a></div></div><!--]--><!----><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item isExternal" href="https://github.com/qdcz" target="_blank" rel="noopener noreferrer" data-v-711da5ba>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-711da5ba><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><ul class="sidebar-links" data-v-7e9d9da8><!--[--><li class="sidebar-link"><a class="sidebar-link-item" href="#é€€å‡ºngè¿›ç¨‹">é€€å‡ºngè¿›ç¨‹</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#ä»£ç†æ–œæ é—®é¢˜">ä»£ç†æ–œæ é—®é¢˜</a><!----></li><li class="sidebar-link"><a class="sidebar-link-item" href="#é‡å¤å‡ºç°å¤šæ¬¡è·¨åŸŸå…è®¸">é‡å¤å‡ºç°å¤šæ¬¡è·¨åŸŸå…è®¸*</a><!----></li><!--]--></ul><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-f058c2ee><div class="container" data-v-f058c2ee><!--[--><!--]--><div style="position:relative;" class="content" data-v-f058c2ee><div><h1 id="_1ã€åŒè¡Œå¯¹æ¯”" tabindex="-1">1ã€åŒè¡Œå¯¹æ¯”</h1><p>IIS</p><p>Apache</p><p>Tomcat</p><p>Lighttpd</p><p>Nginxä¼˜ç‚¹</p><p>5Wå¹¶å‘é‡</p><p>Ngé‡‡ç”¨äº†å¤šè¿›ç¨‹å’ŒI/Oå¤šè·¯å¤ç”¨ï¼ˆepollï¼‰çš„åº•å±‚å®çº¿çš„</p><h1 id="_2ã€åœ¨çº¿éƒ¨ç½²nginxï¼ˆç®€å•å®‰è£…ï¼‰" tabindex="-1">2ã€åœ¨çº¿éƒ¨ç½²nginxï¼ˆç®€å•å®‰è£…ï¼‰</h1><p>1ã€å®‰è£…gccç¼–è¯‘å™¨ã€gccèƒ½å¤„ç†å„ç§è¯­è¨€ ä½¿ç”¨å‘½ä»¤ <code>yum install -y gcc</code>æ¥å®‰è£… æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ <code>gcc-v</code></p><p>2ã€å®‰è£…pcre ä½¿ç”¨å‘½ä»¤<code>yum install -y pcre pcre-devel</code> æ¥å®‰è£… æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ <code>rpm -qa pcre pcre-devel</code></p><p>å› ä¸ºngæœ‰ç”¨åˆ°pcreåº“ï¼ˆå…¼å®¹æ­£åˆ™è¡¨è¾¾å¼åº“ï¼‰rewrite å’Œ http æ¨¡å—éƒ½æœ‰ç”¨åˆ°æ­£åˆ™åº“</p><p>3ã€zlib</p><p>zlibåº“æä¾›äº†å‹ç¼©ç®—æ³• ä½¿ç”¨å‘½ä»¤<code>yum install -y zlib zlib-devel</code> æ¥å®‰è£… æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ <code>rpm -qa zlib zlib-devel</code></p><p>4ã€OpenSSL ä½¿ç”¨å‘½ä»¤<code>yum install -y openssl openssl-devel</code> æ¥å®‰è£… æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ <code>rpm -qa openssl openssl-devel</code></p><p>OpenSSLæ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç çš„è½¯ä»¶åº“åŒ…</p><p>SSLï¼šå®‰å…¨å¥—æ¥åè®®çš„ç¼©å†™ï¼Œå¯ä»¥åœ¨intelnetä¸Šæä¾›ç§˜å¯†æ€§ä¼ è¾“ã€‚</p><p>5ã€åœ¨çº¿ä¸‹è½½ng ä½¿ç”¨å‘½ä»¤<code>wget ngçš„ä¸‹è½½é“¾æ¥</code> ç„¶åä½¿ç”¨<code>tar -zxvf nginx-1.13.9.tar.gz</code> è§£å‹åˆ°å½“å‰æ–‡ä»¶å¤¹æˆ–è€…æŒ‡å®šæ–‡ä»¶å¤¹</p><p>6ã€è¿›å…¥åˆ°ngæ–‡ä»¶å¤¹å†… ä½¿ç”¨å‘½ä»¤ <code>./configure</code> è¿›è¡Œç®€å•å®‰è£…</p><p>7ã€ç„¶åè¿è¡Œ <code>make &amp;&amp; make install</code> è¿›è¡Œå…¨éƒ¨å®‰è£… ï¼ˆé»˜è®¤å®‰è£…è·¯å¾„æ˜¯<code>/usr/local/nginx</code>ï¼‰</p><p>8ã€å¯åŠ¨ng è¿›å…¥åˆ°sbin æ–‡ä»¶å¤¹å†… è¿è¡Œ <code>./nginx</code> å³è¿è¡ŒæˆåŠŸ</p><h1 id="_3ã€ç¦»çº¿éƒ¨ç½²nginxï¼ˆç®€å•å®‰è£…ï¼‰" tabindex="-1">3ã€ç¦»çº¿éƒ¨ç½²nginxï¼ˆç®€å•å®‰è£…ï¼‰</h1><p><a href="http://nginx.org/en/download.html" target="_blank" rel="noopener noreferrer">http://nginx.org/en/download.html</a> åœ¨å®˜ç½‘ä¸‹è½½ngåŒ… é€‰æ‹©linuxç‰ˆ ç„¶åä¸Šä¼ â˜æœåŠ¡å™¨</p><p>å®‰è£…ngæ—¶éœ€è¦å†å®‰è£…ä¸€äº›ç¯å¢ƒæ‰€éœ€çš„åŒ…</p><p>1ã€è¿›å…¥gccæ–‡ä»¶å¤¹ è¿è¡Œ <code> rpm -Uvh *.rpm --nodeps --force</code> å‘½ä»¤ æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ <code>gcc-v</code></p><p>2ã€è¿›å…¥gcc-c++æ–‡ä»¶å¤¹ è¿è¡Œ <code> rpm -Uvh *.rpm --nodeps --force</code> å‘½ä»¤ æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ <code>g++-v</code></p><p>3ã€å®‰è£…PCRE è§£å‹ <code>tar -zxvf pcre-8.35.tar.gz</code> ç„¶å ç¼–è¯‘ ./configure &amp;&amp; make &amp;&amp; make install</p><p>4ã€å®‰è£…libtool è§£å‹ <code> tar -zxvf libtool-2.4.2.tar.gz</code> ç„¶å ç¼–è¯‘ ./configure &amp;&amp; make &amp;&amp; make install</p><p>5ã€å®‰è£…ng è§£å‹ <code>tar -zxvf nginx-1.13.9.tar.gz</code> ç„¶å ç¼–è¯‘ ./configure &amp;&amp; make &amp;&amp; make install</p><p>å¯åŠ¨ngæ–¹å¼ nginxå®‰è£…ç›®å½•åœ°å€ -c nginxé…ç½®æ–‡ä»¶åœ°å€ å¦‚ä¸‹ï¼š</p><div class="language-nginx"><pre><code>/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf            ï¼ˆå®‰è£…åçš„è·¯å¾„ä¼šè¢«å˜åˆ°/usr/local  é‡Œé¢ï¼‰
</code></pre></div><div class="language-nginx"><pre><code>å‘½ä»¤ï¼š 
è·¯å¾„ -s stop 							åœæ­¢ng
è·¯å¾„ -s reload  						é‡å¯ng 


netstat -tunlp   						æŸ¥çœ‹ç«¯å£å ç”¨
netstat -tunlp |grep                      æŸ¥çœ‹æŒ‡å®šç«¯å£
</code></pre></div><h1 id="_4ã€å¤æ‚å®‰è£…" tabindex="-1">4ã€å¤æ‚å®‰è£…</h1><p>ç›¸å½“äºåœ¨configureä¸Šåšä¸€äº›å‘½ä»¤çš„æ·»åŠ </p><p>æ³¨æ„ï¼šè¦é‡æ–°æ·»åŠ configureåé¢è·Ÿçš„åç¼€å¾—å¸è½½ngåé‡æ–°å®‰è£…</p><div class="language-shell"><pre><code>./configure --prefix<span class="token operator">=</span>/usr/local/nginx --with-http_ssl_module --with-openssl<span class="token operator">=</span>/usr/cxy/openssl-1.1.1l
</code></pre></div><h1 id="_5ã€å¸è½½nginx" tabindex="-1">5ã€å¸è½½nginx</h1><p>1ã€<code>./nginx -s stop</code> å…ˆæŠŠngåœæ‰</p><p>2ã€<code>rm -rf /usr/local/nginx</code> å°†ngåˆ é™¤</p><p>3ã€<code>make clean</code> å°†å®‰è£…åŒ…ä¹‹å‰ç¼–è¯‘çš„ç¯å¢ƒæ¸…é™¤æ‰</p><h1 id="_6ã€æ— åœæ­¢æœåŠ¡æ›´æ–°nginxç‰ˆæœ¬" tabindex="-1">6ã€æ— åœæ­¢æœåŠ¡æ›´æ–°nginxç‰ˆæœ¬</h1><p>1)ã€å°†æ—§ç‰ˆæœ¬çš„nginxä¸‹sbinçš„nginxè¿›è¡Œå¤‡ä»½</p><div class="language-shell"><pre><code><span class="token builtin class-name">cd</span> /usr/local/nginx/sbin
<span class="token function">mv</span> nginx nginxold
</code></pre></div><p>2)ã€å°†æ–°ç‰ˆæœ¬çš„å®‰è£…ç›®å½•ç¼–è¯‘åçš„objsç›®å½•ä¸‹çš„nginxæ–‡ä»¶æ‹·è´åˆ°åŸæ¥ <code>/usr/local/nginx/sbin</code> ç›®å½•ä¸‹</p><div class="language-shell"><pre><code><span class="token builtin class-name">cd</span> ~/nginx/newVersion/nginx-1.16.1/objs
<span class="token function">cp</span> nginx /usr/local/nginx/sbin
</code></pre></div><p>3)ã€å‘é€ä¿¡å·USR2ç»™Nginxçš„æ—§ç‰ˆæœ¬å¯¹åº”çš„masterè¿›ç¨‹</p><div class="language-shell"><pre><code><span class="token function">kill</span> -USR2 <span class="token variable"><span class="token variable">`</span><span class="token function">more</span> /usr/local/logs/nginx.pid<span class="token variable">`</span></span>
</code></pre></div><p>4)ã€å‘é€ä¿¡å·QUITç»™Nginxçš„æ—§ç‰ˆæœ¬å¯¹åº”çš„masterè¿›ç¨‹</p><div class="language-shell"><pre><code><span class="token function">kill</span> -QUIT <span class="token variable"><span class="token variable">`</span><span class="token function">more</span> /usr/local/logs/nginx.pid.oldpid<span class="token variable">`</span></span>
</code></pre></div><h1 id="_7ã€nginxæœåŠ¡å™¨å‡çº§" tabindex="-1">7ã€nginxæœåŠ¡å™¨å‡çº§</h1><p>æ–¹æ¡ˆä¸€ã€ä½¿ç”¨nginxæœåŠ¡ä¿¡æ¯å‡çº§</p><p>å¦‚ä¸Š6</p><p>æ–¹æ¡ˆäºŒã€ä½¿ç”¨nginxå®‰è£…ç›®å½•çš„makeå‘½ä»¤å‡çº§</p><p>1)ã€å°†æ—§ç‰ˆæœ¬çš„nginxä¸‹sbinçš„nginxè¿›è¡Œå¤‡ä»½</p><div class="language-shell"><pre><code><span class="token builtin class-name">cd</span> /usr/local/nginx/sbin
<span class="token function">mv</span> nginx nginxold
</code></pre></div><p>2)ã€å°†æ–°ç‰ˆæœ¬çš„å®‰è£…ç›®å½•ç¼–è¯‘åçš„objsç›®å½•ä¸‹çš„nginxæ–‡ä»¶æ‹·è´åˆ°åŸæ¥ <code>/usr/local/nginx/sbin</code> ç›®å½•ä¸‹</p><div class="language-shell"><pre><code><span class="token builtin class-name">cd</span> ~/nginx/newVersion/nginx-1.16.1/objs
<span class="token function">cp</span> nginx /usr/local/nginx/sbin
</code></pre></div><p>3)ã€è¿›å…¥åˆ°å®‰è£…ç›®å½•ï¼ˆæ³¨æ„å†nginxç›®å½•ä¸‹ è€Œä¸æ˜¯sbinç›®å½•ä¸‹ï¼‰ï¼Œæ‰§è¡Œmake upgrade</p><p>4)ã€éªŒè¯ nginx -V</p><h1 id="_8ã€useræŒ‡ä»¤" tabindex="-1">8ã€useræŒ‡ä»¤</h1><p>ç”¨äºé…ç½®è¿è¡ŒnginxæœåŠ¡å™¨çš„workerè¿›ç¨‹çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„</p><div class="language-"><pre><code>useradd www   ä¼šåœ¨homeç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªwwwçš„ç”¨æˆ·
user www      è®¾ç½®ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯  www
åœ¨home/www/   ç›®å½•ä¸‹æ”¾ç½®ä¸€ä¸ªindex.htmlé¡µé¢


ä¿®æ”¹ngä¸€ä¸ªhttpæ¨¡å—çš„é…ç½®ï¼ˆå¯ä»¥å…ˆçœ‹ä¸‹ngæ•´ä½“é…ç½®æ–‡ä»¶ï¼‰
user  www;
location /{
	root	/home/www/html
	index	/index.html index.htm
}
</code></pre></div><h1 id="_9ã€workè¿›ç¨‹å’Œmasterè¿›ç¨‹" tabindex="-1">9ã€workè¿›ç¨‹å’Œmasterè¿›ç¨‹</h1><p>å¦‚æœè¦å…³é—­workè¿›ç¨‹</p><div class="language-nginx"><pre><code><span class="token comment"># user  nobody;         	# ç”¨æˆ·ç»„</span>
master_process	off    	<span class="token comment"># é»˜è®¤ä½¿ç”¨on å¼€å¯å·¥ä½œè¿›ç¨‹</span>
worker_processes  1		<span class="token comment"># ç”¨äºé…ç½®nginxç”Ÿæˆå·¥ä½œè¿›ç¨‹çš„æ•°é‡ï¼Œè¿™æ˜¯nginxæœåŠ¡å™¨å®ç°å¹¶å‘å¤„ç†æœåŠ¡çš„å…³é”®æ‰€åœ¨ï¼Œå»ºè®®ä¸æœåŠ¡å™¨cpuå†…æ ¸æ•°ä¿æŒä¸€è‡´</span>
</code></pre></div><p>æŒ‡å®šworkè¿›ç¨‹çš„æ•°é‡</p><div class="language-nginx"><pre><code><span class="token directive"><span class="token keyword">worker_processes</span>  <span class="token number">2</span></span><span class="token punctuation">;</span>
</code></pre></div><h1 id="_9ã€ngå¸¸ä½¿ç”¨çš„ä¸€äº›å‘½ä»¤" tabindex="-1">9ã€ngå¸¸ä½¿ç”¨çš„ä¸€äº›å‘½ä»¤</h1><div class="language-shell"><pre><code><span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> nginx   è¿‡æ»¤å‡ºå…³äºngçš„è¿›ç¨‹ä¿¡æ¯
./nginx -t  æ£€æŸ¥configé…ç½®æ–‡ä»¶æ˜¯å¦æœ‰é”™
./nginx -T  æ£€æŸ¥configé…ç½®æ–‡ä»¶æ˜¯å¦æœ‰é”™å¹¶æ‰“å°å‡ºé…ç½®æ–‡ä»¶
./nginx -tq æ£€æŸ¥configé…ç½®æ–‡ä»¶æ˜¯å¦æœ‰é”™å¹¶æ‰“å°å‡ºé…ç½®æ–‡ä»¶ä¸­å‡ºé”™çš„ä½ç½®å’Œé”™è¯¯
</code></pre></div><h2 id="é€€å‡ºngè¿›ç¨‹" tabindex="-1">é€€å‡ºngè¿›ç¨‹</h2><div class="language-shell"><pre><code><span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> nginx 		æ‹¿åˆ°è¿›ç¨‹å·
<span class="token function">more</span> <span class="token punctuation">..</span>/logs/nginx.pid		æ‹¿åˆ°è¿›ç¨‹å· ä¸¤ç§æ–¹å¼éƒ½å¯
<span class="token function">kill</span> -<span class="token environment constant">TERM</span> <span class="token number">14270</span>    		æ€æ‰è¿›ç¨‹   å…³äº<span class="token environment constant">TERM</span>çœ‹å¦‚ä¸‹è¡¨
</code></pre></div><div class="language-shell"><pre><code>./nginx -s stop 	<span class="token comment"># åœæ­¢ng</span>
./nginx -s reload 	<span class="token comment"># é‡å¯ng</span>
./nginx -s start 	<span class="token comment"># å¯åŠ¨ng</span>
nginx -s æ˜¯ç»™nginxå‘ä¿¡å·  å¦‚æœæœªå¯åŠ¨è¿‡ç›´æ¥ /usr/local/nginx/sbin/nginx å¯åŠ¨å³å¯

./nginx -s quit     <span class="token comment"># è§å¦‚ä¸‹</span>
./nginx -s hub
./nginx -s usr1
./nginx -s usr2
./nginx -s winch

./nginx -g <span class="token string">&quot;pid logs/test.pid&quot;</span>		<span class="token comment"># ä»¥æºå¸¦å…¨å±€é…ç½®çš„æ–¹æ³•å¯åŠ¨ng</span>
</code></pre></div><table><thead><tr><th style="text-align:center;"><strong>TERM, INT</strong></th><th style="text-align:left;">Quick shutdown ç›´æ¥æ€æ­»è¿›ç¨‹ï¼ˆç²—æš´ï¼‰</th></tr></thead><tbody><tr><td style="text-align:center;"><strong>QUIT</strong></td><td style="text-align:left;">Graceful shutdown ä¼˜é›…çš„å…³é—­è¿›ç¨‹,å³ç­‰è¯·æ±‚ç»“æŸåå†å…³é—­ï¼ˆæ¨èä½¿ç”¨ï¼‰</td></tr><tr><td style="text-align:center;"><strong>HUP</strong></td><td style="text-align:left;">Configuration reload ,Start the new worker processes with a new configuralltion Gracefully shutdown the old worker processes<br>(æ”¹å˜é…ç½®æ–‡ä»¶,å¹³æ»‘çš„é‡è¯»é…ç½®æ–‡ä»¶ï¼‰</td></tr><tr><td style="text-align:center;"><strong>USR1</strong></td><td style="text-align:left;">Reopen the log files é‡è¯»æ—¥å¿—,åœ¨æ—¥å¿—æŒ‰æœˆ/æ—¥åˆ†å‰²æ—¶æœ‰ç”¨</td></tr><tr><td style="text-align:center;"><strong>USR2</strong></td><td style="text-align:left;">Upgrade Executable on the fly å¹³æ»‘çš„å‡çº§</td></tr><tr><td style="text-align:center;"><strong>WINCH</strong></td><td style="text-align:left;">Gracefully shutdown the worker processes ä¼˜é›…å…³é—­æ—§çš„è¿›ç¨‹(é…åˆUSR2æ¥è¿›è¡Œå‡çº§)</td></tr></tbody></table><div class="language-shell"><pre><code><span class="token comment"># å¦‚æœæˆ‘åˆ é™¤äº†ngçš„æ—¥å¿—  è¿™æ—¶æˆ‘ä¸æƒ³é‡å¯ åˆè¦é‡æ–°ç”Ÿæˆæ—¥å¿—å¯ä»¥ä½¿ç”¨</span>
<span class="token function">kill</span> -USR1 <span class="token variable"><span class="token variable">`</span><span class="token function">more</span> /usr/local/nginx/logs/nginx.pid<span class="token variable">`</span></span>

<span class="token comment"># åªä¼˜é›…çš„å…³é—­workè¿›ç¨‹</span>
<span class="token function">kill</span> -WINCH <span class="token number">14270</span>

<span class="token comment"># ä¸é‡å¯nginxåˆè¦å¹³æ»‘çš„å‡çº§ng</span>
<span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> nginx 		æ‹¿åˆ°è¿›ç¨‹å·
<span class="token function">kill</span> -USR2 <span class="token number">14270</span>		
<span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> nginx 		ä½ ä¼šå‘ç°æœ‰ä¸¤ä¸ªmasterè¿›ç¨‹å’Œworkè¿›ç¨‹
è¿›å…¥åˆ°logsæ–‡ä»¶å†…  ä¼šå‡ºç°ä¸¤ä¸ªæ–‡ä»¶  ä¸€ä¸ªæ˜¯nginx.pid.oldbin ä¸€ä¸ªæ˜¯nginx.pid
å¦‚æœç¡®å®šæœåŠ¡å™¨å‡çº§æˆåŠŸä¹‹å  æ‰§è¡Œ  <span class="token function">kill</span> -QUIT æ—§çš„ä¸»è¿›ç¨‹å·  ç„¶åå°±å‡çº§æˆåŠŸäº†
</code></pre></div><h1 id="åå‘ä»£ç†" tabindex="-1">åå‘ä»£ç†</h1><h2 id="ä»£ç†æ–œæ é—®é¢˜" tabindex="-1"><strong>ä»£ç†æ–œæ é—®é¢˜</strong></h2><p><strong>1.ä»¥ä¸‹æ˜¯åŠ ä¸åŠ æ–œæ éƒ½æ˜¯ä¸€æ ·çš„è·¯å¾„</strong> éƒ½ä¼šè®¿é—® <code>http://10.142.124.221:18080/</code></p><div class="language-nginx"><pre><code><span class="token directive"><span class="token keyword">server</span></span><span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> localhost</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /</span><span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://10.142.124.221:18080</span><span class="token punctuation">;</span>
        <span class="token comment"># proxy_pass http://10.142.124.221:18080/;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>2.å¸¦æœ‰å‰ç¼€çš„è¯</strong></p><p>ç¬¬ä¸€ä¸ªä¼šè¿”å› <code>http://10.142.124.221:18080/server/index.html</code></p><p>ç¬¬äºŒä¸ªä¼šè¿”å› <code>http://10.142.124.221:18080/index.html</code></p><div class="language-nginx"><pre><code><span class="token directive"><span class="token keyword">server</span></span><span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> localhost</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /server</span><span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://10.142.124.221:18080</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://10.142.124.221:18080/</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ–è€…å¦‚æœæƒ³è¾¾åˆ°ç¬¬äºŒä¸ªçš„æ•ˆæœä¹Ÿå¯ä»¥è¿›è¡Œå¦‚ä¸‹æ“ä½œ</p><div class="language-nginx"><pre><code><span class="token directive"><span class="token keyword">server</span></span><span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span> localhost</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /proxy_api_out/</span><span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">rewrite</span> ^/proxy_api_out/(.*)$ /<span class="token variable">$1</span> break</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://10.142.124.221:18080</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ä»¥ä¸Šæ˜¯ä¼šåŒ¹é…è·¯å¾„ä¸Šçš„/proxy_api_out/  å¦‚æœåŒ¹é…ä¸Šä¼šè¿›è¡Œè·¯å¾„é‡å†™
</code></pre></div><h2 id="é‡å¤å‡ºç°å¤šæ¬¡è·¨åŸŸå…è®¸" tabindex="-1">é‡å¤å‡ºç°å¤šæ¬¡è·¨åŸŸå…è®¸*</h2><p>å¯ä»¥ä½¿ç”¨<code>proxy_set_header Origin &quot;&quot;;</code>å°†ä»£ç†æºçš„å…è®¸æ‰€æœ‰è·¨åŸŸæ¸…é™¤æ‰ ç„¶åå†è‡ªå·±è®¾ç½®ä¸Š</p><h1 id="linux-sslè‡ªç­¾è¯ä¹¦-nginx-å°†httpå‡çº§æˆhttps" tabindex="-1">linux+sslè‡ªç­¾è¯ä¹¦+nginx å°†httpå‡çº§æˆhttps</h1><p>nginx éœ€è¦å¼€å¯ sslæ¨¡å—</p><p>æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</p><div class="language-nginx"><pre><code>./configure --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-openssl=/usr/cxy/ssl/openssl-1.1.1

<span class="token comment"># ï¼ˆ/usr/cxy/ssl/openssl-1.1.1   æ˜¯å­˜æ”¾opensslæºç çš„åœ°æ–¹  å¯è‡ªè¡Œå»nginxå®˜ç½‘ä¸‹è½½ï¼‰</span>

ç„¶åmake 
ç„¶åmake install
</code></pre></div><p>1)ã€åˆ›å»ºCAç§é’¥ï¼Œ åˆ©ç”¨ç§é’¥åˆ›å»ºCAè¯ä¹¦</p><div class="language-shell"><pre><code><span class="token comment">#åˆ›å»ºCAç§é’¥</span>
openssl genrsa -out rootCA.key <span class="token number">2048</span>
<span class="token comment">#åˆ›å»ºCAè¯ä¹¦</span>
openssl req -x509 -new -nodes -key rootCA.key -sha256 -days <span class="token number">1024</span> -out rootCA.crt
</code></pre></div><p>2)ã€åˆ›å»ºserverç§é’¥ä»¥åŠCSR</p><div class="language-shell"><pre><code><span class="token comment">#åˆ›å»ºserverç§é’¥</span>
openssl genrsa -out control.key <span class="token number">2048</span>
<span class="token comment">#æ ¹æ®é…ç½®è¦çš„opensslå‚æ•°åˆ›å»ºæœåŠ¡å™¨csræ–‡ä»¶ï¼Œ åé¢ä¼šç”¨åˆ°</span>
openssl req -new -key control.key -out control.csr -extensions v3_req
</code></pre></div><p>3)ã€ä½¿ç”¨CAè¯ä¹¦ç»™server.csråšç­¾å</p><div class="language-shell"><pre><code>openssl x509 -req -days <span class="token number">500</span> -in control.csr -CA rootCA.crt -CAkey rootCA.key -CAcreateserial -out control.crt -sha256 -extensions v3_req
</code></pre></div><p>4)ã€å°†è¯ä¹¦æ”¾åˆ°nginxçš„confç›®å½•ä¸‹ å¦‚æœä¸è¿™ä¹ˆåš ä½ ä¹Ÿå¯åœ¨é…ç½®ä¸­æŒ‡å®šè¯ä¹¦çš„ä½ç½®</p><div class="language-nginx"><pre><code><span class="token directive"><span class="token keyword">ssl_certificate</span>      server.crt</span><span class="token punctuation">;</span>
<span class="token directive"><span class="token keyword">ssl_certificate_key</span>  server.key</span><span class="token punctuation">;</span>
</code></pre></div><p>ngå®Œæ•´é…ç½®å¦‚ä¸‹ï¼š</p><div class="language-shell"><pre><code>control <span class="token punctuation">{</span>
    listen       <span class="token number">443</span> ssl<span class="token punctuation">;</span>
    server_name  <span class="token number">192.168</span>.237.128<span class="token punctuation">;</span>

    ssl_certificate      control.crt<span class="token punctuation">;</span>
    ssl_certificate_key  control.key<span class="token punctuation">;</span>
    ssl_session_cache    shared:SSL:1m<span class="token punctuation">;</span>
    ssl_session_timeout  5m<span class="token punctuation">;</span>
    ssl_ciphers  HIGH:<span class="token operator">!</span>aNULL:<span class="token operator">!</span>MD5<span class="token punctuation">;</span>
    ssl_prefer_server_ciphers  on<span class="token punctuation">;</span>
    location / <span class="token punctuation">{</span>
        <span class="token comment"># rewrite ^/snxun/(.*)$ /$1 break;</span>
        proxy_pass http://127.0.0.1:7001<span class="token punctuation">;</span> 
        proxy_pass_header Server<span class="token punctuation">;</span> 
        proxy_set_header Host <span class="token variable">$http_host</span><span class="token punctuation">;</span> 
        proxy_redirect off<span class="token punctuation">;</span> 
        proxy_set_header X-Real-IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span> 
        proxy_set_header X-Scheme <span class="token variable">$scheme</span><span class="token punctuation">;</span> 
        proxy_connect_timeout <span class="token number">60</span><span class="token punctuation">;</span> 
        proxy_read_timeout <span class="token number">120</span><span class="token punctuation">;</span>
        root   html<span class="token punctuation">;</span>
        index  index.html index.htm<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="æ…¢æ…¢å®Œå–„é…ç½®æ–‡ä»¶" tabindex="-1">æ…¢æ…¢å®Œå–„é…ç½®æ–‡ä»¶</h1><div class="language-nginx"><pre><code><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
    <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">8688</span></span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>
    <span class="token comment">#charset koi8-r;</span>
    <span class="token directive"><span class="token keyword">access_log</span>  logs/8688_haojin.access.log  main</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">error_log</span>   logs/8688_haojin.error.log</span><span class="token punctuation">;</span>
    <span class="token directive"><span class="token keyword">location</span> /</span><span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">root</span>   html</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">index</span>  index.html index.htm</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token directive"><span class="token keyword">location</span> /haojin-api-out/</span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Origin&#39;</span> <span class="token string">&quot;*&quot;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Methods&#39;</span> <span class="token string">&#39;GET, POST, OPTIONS&#39;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Headers&#39;</span> <span class="token string">&#39;DNT,web-token,app-token,Authorization,Accept,Origin,Keep-Alive,User-Agent,X-Mx-ReqToken,X-Data-Type,X-Auth-Token,vaildMin,If-Modified-Since,Cache-Control,Content-Type,Range,pageNum,pageSize&#39;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Expose-Headers&#39;</span> <span class="token string">&#39;Content-Length,Content-Range&#39;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> Pragma <span class="token string">&quot;no-cache&quot;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> Cache-Control <span class="token string">&quot;no-store, no-cache, must-revalidate, post-check=0, pre-check=0&quot;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://10.249.0.31:18080/</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span> Origin <span class="token string">&quot;&quot;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$request_method</span> = OPTIONS)</span><span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">return</span> <span class="token number">200</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token directive"><span class="token keyword">location</span> /haojin-api-in/</span> <span class="token punctuation">{</span>
        <span class="token comment"># rewrite ^/haojin-api/(.*)$ /$1 break;</span>
        <span class="token comment"># add_header &#39;Access-Control-Allow-Credentials&#39; &#39;true&#39;;</span>
        <span class="token comment"># add_header &#39;Access-Control-Allow-Origin&#39; $http_origin;</span>
        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Origin&#39;</span> <span class="token string">&quot;*&quot;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Methods&#39;</span> <span class="token string">&#39;GET, POST, OPTIONS&#39;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Allow-Headers&#39;</span> <span class="token string">&#39;DNT,web-token,app-token,Authorization,Accept,Origin,Keep-Alive,User-Agent,X-Mx-ReqToken,X-Data-Type,X-Auth-Token,vaildMin,If-Modified-Since,Cache-Control,Content-Type,Range,pageNum,pageSize&#39;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> <span class="token string">&#39;Access-Control-Expose-Headers&#39;</span> <span class="token string">&#39;Content-Length,Content-Range&#39;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> Pragma <span class="token string">&quot;no-cache&quot;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">add_header</span> Cache-Control <span class="token string">&quot;no-store, no-cache, must-revalidate, post-check=0, pre-check=0&quot;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_pass</span> http://10.142.124.221:18080/</span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">proxy_set_header</span> Origin <span class="token string">&quot;&quot;</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">if</span> (<span class="token variable">$request_method</span> = OPTIONS)</span><span class="token punctuation">{</span>
            <span class="token directive"><span class="token keyword">return</span> <span class="token number">200</span></span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-shell"><pre><code><span class="token comment">#user  nobody;</span>
worker_processes  <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">#error_log  logs/error.log;</span>
<span class="token comment">#error_log  logs/error.log  notice;</span>
<span class="token comment">#error_log  logs/error.log  info;</span>

<span class="token comment">#pid        logs/nginx.pid;</span>


events <span class="token punctuation">{</span>
    worker_connections  <span class="token number">1024</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


http <span class="token punctuation">{</span>
    include       mime.types<span class="token punctuation">;</span>
    default_type  application/octet-stream<span class="token punctuation">;</span>

    <span class="token comment">#log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span>
    <span class="token comment">#                  &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span>
    <span class="token comment">#                  &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;</span>

    <span class="token comment">#access_log  logs/access.log  main;</span>

    sendfile        on<span class="token punctuation">;</span>
    <span class="token comment">#tcp_nopush     on;</span>

    <span class="token comment">#keepalive_timeout  0;</span>
    keepalive_timeout  <span class="token number">65</span><span class="token punctuation">;</span>

    <span class="token comment">#gzip  on;</span>

    control <span class="token punctuation">{</span>
        listen       <span class="token number">8688</span><span class="token punctuation">;</span>
        server_name  localhost<span class="token punctuation">;</span>

        <span class="token comment">#charset koi8-r;</span>

        <span class="token comment">#access_log  logs/host.access.log  main;</span>

         location / <span class="token punctuation">{</span>
            root   html<span class="token punctuation">;</span>
            index  index.html index.htm<span class="token punctuation">;</span>
	    <span class="token comment"># proxy_pass http://10.249.0.31:18080;</span>
	    proxy_pass http://10.142.124.221:18080<span class="token punctuation">;</span>
            add_header Access-Control-Allow-Methods *<span class="token punctuation">;</span>
            add_header Access-Control-Max-Age <span class="token number">3600</span><span class="token punctuation">;</span>
            <span class="token comment"># add_header Access-Control-Allow-Credentials true;</span>
            <span class="token comment"># more_clear_headers Access-Control-Allow-Origin;</span>
            <span class="token comment"># add_header Access-Control-Allow-Origin $http_origin;</span>
            add_header Access-Control-Allow-Headers 
            <span class="token variable">$http_access_control_request_headers</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$request_method</span> <span class="token operator">=</span> OPTIONS<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token builtin class-name">return</span> <span class="token number">200</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">#error_page  404              /404.html;</span>

        <span class="token comment"># redirect control error pages to the static page /50x.html</span>
        <span class="token comment">#</span>
        error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html<span class="token punctuation">;</span>
        location <span class="token operator">=</span> /50x.html <span class="token punctuation">{</span>
            root   html<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span>
        <span class="token comment">#</span>
        <span class="token comment">#location ~ \.php$ {</span>
        <span class="token comment">#    proxy_pass   http://127.0.0.1;</span>
        <span class="token comment">#}</span>

        <span class="token comment"># pass the PHP scripts to FastCGI control listening on 127.0.0.1:9000</span>
        <span class="token comment">#</span>
        <span class="token comment">#location ~ \.php$ {</span>
        <span class="token comment">#    root           html;</span>
        <span class="token comment">#    fastcgi_pass   127.0.0.1:9000;</span>
        <span class="token comment">#    fastcgi_index  index.php;</span>
        <span class="token comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span>
        <span class="token comment">#    include        fastcgi_params;</span>
        <span class="token comment">#}</span>

        <span class="token comment"># deny access to .htaccess files, if Apache&#39;s document root</span>
        <span class="token comment"># concurs with nginx&#39;s one</span>
        <span class="token comment">#</span>
        <span class="token comment">#location ~ /\.ht {</span>
        <span class="token comment">#    deny  all;</span>
        <span class="token comment">#}</span>
    <span class="token punctuation">}</span>
    
    
    control <span class="token punctuation">{</span>
        listen       <span class="token number">7001</span><span class="token punctuation">;</span>
        server_name  localhost<span class="token punctuation">;</span>

        <span class="token comment">#charset koi8-r;</span>

        <span class="token comment">#access_log  logs/host.access.log  main;</span>

         location / <span class="token punctuation">{</span>
             root   html<span class="token punctuation">;</span>
            index  index.html index.htm<span class="token punctuation">;</span>
            proxy_pass http://101.231.77.77:28088/<span class="token punctuation">;</span>
             add_header Access-Control-Allow-Methods *<span class="token punctuation">;</span>
            add_header Access-Control-Max-Age <span class="token number">3600</span><span class="token punctuation">;</span>
            <span class="token comment"># add_header Access-Control-Allow-Credentials true;</span>
            <span class="token comment"># more_clear_headers Access-Control-Allow-Origin;</span>
            <span class="token comment"># add_header Access-Control-Allow-Origin $http_origin;</span>
            add_header Access-Control-Allow-Headers 
            <span class="token variable">$http_access_control_request_headers</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$request_method</span> <span class="token operator">=</span> OPTIONS<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token builtin class-name">return</span> <span class="token number">200</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">#error_page  404              /404.html;</span>

        <span class="token comment"># redirect control error pages to the static page /50x.html</span>
        <span class="token comment">#</span>
        error_page   <span class="token number">500</span> <span class="token number">502</span> <span class="token number">503</span> <span class="token number">504</span>  /50x.html<span class="token punctuation">;</span>
        location <span class="token operator">=</span> /50x.html <span class="token punctuation">{</span>
            root   html<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span>
        <span class="token comment">#</span>
        <span class="token comment">#location ~ \.php$ {</span>
        <span class="token comment">#    proxy_pass   http://127.0.0.1;</span>
        <span class="token comment">#}</span>

        <span class="token comment"># pass the PHP scripts to FastCGI control listening on 127.0.0.1:9000</span>
        <span class="token comment">#</span>
        <span class="token comment">#location ~ \.php$ {</span>
        <span class="token comment">#    root           html;</span>
        <span class="token comment">#    fastcgi_pass   127.0.0.1:9000;</span>
        <span class="token comment">#    fastcgi_index  index.php;</span>
        <span class="token comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span>
        <span class="token comment">#    include        fastcgi_params;</span>
        <span class="token comment">#}</span>

        <span class="token comment"># deny access to .htaccess files, if Apache&#39;s document root</span>
        <span class="token comment"># concurs with nginx&#39;s one</span>
        <span class="token comment">#</span>
        <span class="token comment">#location ~ /\.ht {</span>
        <span class="token comment">#    deny  all;</span>
        <span class="token comment">#}</span>
    <span class="token punctuation">}</span>


    <span class="token comment"># another virtual host using mix of IP-, name-, and port-based configuration</span>
    <span class="token comment">#</span>
    <span class="token comment">#control {</span>
    <span class="token comment">#    listen       8000;</span>
    <span class="token comment">#    listen       somename:8080;</span>
    <span class="token comment">#    server_name  somename  alias  another.alias;</span>

    <span class="token comment">#    location / {</span>
    <span class="token comment">#        root   html;</span>
    <span class="token comment">#        index  index.html index.htm;</span>
    <span class="token comment">#    }</span>
    <span class="token comment">#}</span>


    <span class="token comment"># HTTPS control</span>
    <span class="token comment">#</span>
    <span class="token comment">#control {</span>
    <span class="token comment">#    listen       443 ssl;</span>
    <span class="token comment">#    server_name  localhost;</span>

    <span class="token comment">#    ssl_certificate      cert.pem;</span>
    <span class="token comment">#    ssl_certificate_key  cert.key;</span>

    <span class="token comment">#    ssl_session_cache    shared:SSL:1m;</span>
    <span class="token comment">#    ssl_session_timeout  5m;</span>

    <span class="token comment">#    ssl_ciphers  HIGH:!aNULL:!MD5;</span>
    <span class="token comment">#    ssl_prefer_server_ciphers  on;</span>

    <span class="token comment">#    location / {</span>
    <span class="token comment">#        root   html;</span>
    <span class="token comment">#        index  index.html index.htm;</span>
    <span class="token comment">#    }</span>
    <span class="token comment">#}</span>

<span class="token punctuation">}</span>

</code></pre></div><div class="language-shell"><pre><code>./nginx -s reload  				// é‡å¯
</code></pre></div><h1 id="ä¸ªäººè®°å½•" tabindex="-1">ä¸ªäººè®°å½•</h1><p>P25</p><p><a href="https://www.bilibili.com/video/BV1og411T76d?p=25&amp;spm_id_from=pageDriver" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/BV1og411T76d?p=25&amp;spm_id_from=pageDriver</a></p></div></div><footer class="page-footer" data-v-f058c2ee data-v-4d1950e8><div class="edit" data-v-4d1950e8><div class="edit-link" data-v-4d1950e8 data-v-d1f281aa><!----></div></div><div class="updated" data-v-4d1950e8><p class="last-updated" data-v-4d1950e8 data-v-01ad1c9a><span class="prefix" data-v-01ad1c9a>æœ€è¿‘æ›´æ–°æ—¶é—´:</span><span class="datetime" data-v-01ad1c9a></span></p></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"ideshortcutkey_webstorm.md\":\"18c6c91e\",\"about_index.md\":\"266d606d\",\"client_electron_base.md\":\"73b81831\",\"client_electron_index.md\":\"63ff8f07\",\"client_typescript_index.md\":\"2609fcb2\",\"client_css_æ»šåŠ¨æ¡.md\":\"704dd147\",\"client_javascript_xmlhttprequest.md\":\"ea195791\",\"client_javascript_base.md\":\"fd1f6794\",\"client_javascript_index.md\":\"eece4482\",\"client_javascript_å‡½æ•°.md\":\"bf6b65b9\",\"concat_index.md\":\"a782833f\",\"environmentconstruction_index.md\":\"b7b45d45\",\"environmentconstruction_linux.md\":\"491489b6\",\"environmentconstruction_mongodbç¦»çº¿å®‰è£….md\":\"9d0f7670\",\"environmentconstruction_mysqlç¦»çº¿å®‰è£….md\":\"a3088b54\",\"environmentconstruction_nginx.md\":\"f2832f95\",\"environmentconstruction_redisç¦»çº¿å®‰è£….md\":\"29fa9b75\",\"home_home.md\":\"38f1fc65\",\"index.md\":\"b65b705c\",\"interest_drug_index.md\":\"90a8b05a\",\"interest_music_index.md\":\"3981382e\",\"npmpackage_index.md\":\"93ce991e\",\"npmpackage_log4js.md\":\"6d781e35\",\"qdcz-note.md\":\"4557beaf\",\"service_linux_index.md\":\"a9464d28\",\"service_linux_linux.md\":\"4e8c9496\",\"service_linux_å­˜å‚¨å•ä½.md\":\"1e89b4f1\",\"service_mongodb_base.md\":\"6ca155d3\",\"service_mongodb_index.md\":\"4208220d\",\"service_mongodb_å»ºç«‹ttlç´¢å¼•.md\":\"53de734b\",\"service_nginx_index.md\":\"11980c9c\",\"service_nginx_windowç‰ˆæœ¬.md\":\"fe4f4779\",\"service_nodejs_base.md\":\"adf20931\",\"service_nodejs_buffer.md\":\"31afcf78\",\"service_nodejs_child_process.md\":\"b4f536bf\",\"service_nodejs_index.md\":\"b32f8eae\",\"service_nodejs_nodeåˆ†äº«è¯¾1.md\":\"f7826959\",\"service_nodejs_process.md\":\"b9b704bb\",\"service_nodejs_stream.md\":\"18fec455\",\"service_nodejs_å·¥å…·å‡½æ•°.md\":\"0a5d610f\",\"service_nodejs_æ–‡ä»¶æè¿°ç¬¦.md\":\"d3c6d470\",\"service_nodejs_æ—¥å¿—ç³»ç»Ÿè®°å½•.md\":\"6aca9a07\",\"service_nodejs_æ··æ·†ç¼–è¯‘æ‰“åŒ….md\":\"33ae689f\",\"service_nodejs_é”.md\":\"6d1431a0\",\"service_koa_index.md\":\"8c028d04\",\"service_koa_æ´‹è‘±æ¨¡å‹.md\":\"26a07483\",\"softwareengineering_é¢å‘å¯¹è±¡ç¼–ç¨‹.md\":\"7d674901\",\"temporary_index.md\":\"5a23302e\",\"temporary_recentplan.md\":\"4a33a5c9\",\"temporary_websocketforauthbynodejs.md\":\"2ff12679\",\"temporary_work_day_work_report.md\":\"b2cedae0\",\"temporary_work_todayplan.md\":\"b7eb1c2b\",\"temporary_work_weekly_work_report.md\":\"26f025a0\",\"windowsystem_cmdå‘½ä»¤.md\":\"e4ff76d1\",\"windowsystem_index.md\":\"ef9c447f\",\"windowsystem_åˆ›å»ºæœ¬åœ°å…±äº«æ–‡ä»¶å¤¹.md\":\"76d9012b\"}")</script>
    <script type="module" async src="/assets/app.f3070ad9.js"></script>
    
  </body>
</html>