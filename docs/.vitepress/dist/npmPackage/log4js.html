<!DOCTYPE html>
<html lang="en-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>log4js包用法 | 澜漾</title>
    <meta name="description" content="广天下之广,深天下之深">
    <link rel="stylesheet" href="/assets/style.49f07aca.css">
    <link rel="modulepreload" href="/assets/Home.83738dfc.js">
    <link rel="modulepreload" href="/assets/app.f3070ad9.js">
    <link rel="modulepreload" href="/assets/npmPackage_log4js.md.6d781e35.lean.js">
    
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <meta name="keywords" content="澜漾">
  <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.css">
  <script src="https://lib.baomitu.com/gitalk/1.7.0/gitalk.min.js"></script>
  <script src="https://lib.baomitu.com/axios/0.21.1/axios.js"></script>
  <meta name="twitter:title" content="log4js包用法 | 澜漾">
  <meta property="og:title" content="log4js包用法 | 澜漾">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme"><header class="nav-bar" data-v-d186b2c2><div class="sidebar-button" data-v-d186b2c2><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class></path></svg></div><a class="nav-bar-title" href="/" aria-label="澜漾, back to home" data-v-d186b2c2 data-v-34a93bc8><img class="logo" src="/logo2.jpg" alt="Logo" data-v-34a93bc8> 澜漾</a><div class="flex-grow" data-v-d186b2c2></div><div class="nav" data-v-d186b2c2><nav class="nav-links" data-v-d186b2c2 data-v-30b7e073><!--[--><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/" data-v-711da5ba>🏠 首页 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/home/home" data-v-711da5ba>码上行动 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/IDEShortcutKey/WebStorm" data-v-711da5ba>编辑器快捷键 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/environmentConstruction/index" data-v-711da5ba>环境搭建 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/windowSystem/index" data-v-711da5ba>window <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/service/Linux/index" data-v-711da5ba>linux <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/about/index" data-v-711da5ba>🔨关于 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/concat/index" data-v-711da5ba>👫友情链接 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/temporary/index" data-v-711da5ba>临时存储 <!----></a></div></div><!--]--><!----><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item isExternal" href="https://github.com/qdcz" target="_blank" rel="noopener noreferrer" data-v-711da5ba>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-711da5ba><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav></div><!--[--><!--]--></header><aside class="sidebar" data-v-7e9d9da8><nav class="nav-links nav" data-v-7e9d9da8 data-v-30b7e073><!--[--><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/" data-v-711da5ba>🏠 首页 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/home/home" data-v-711da5ba>码上行动 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/IDEShortcutKey/WebStorm" data-v-711da5ba>编辑器快捷键 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/environmentConstruction/index" data-v-711da5ba>环境搭建 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/windowSystem/index" data-v-711da5ba>window <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/service/Linux/index" data-v-711da5ba>linux <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/about/index" data-v-711da5ba>🔨关于 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/concat/index" data-v-711da5ba>👫友情链接 <!----></a></div></div><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item" href="/temporary/index" data-v-711da5ba>临时存储 <!----></a></div></div><!--]--><!----><div class="item" data-v-30b7e073><div class="nav-link" data-v-30b7e073 data-v-711da5ba><a class="item isExternal" href="https://github.com/qdcz" target="_blank" rel="noopener noreferrer" data-v-711da5ba>GitHub <svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15" data-v-711da5ba><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></nav><!--[--><!--]--><!----><!--[--><!--]--></aside><div class="sidebar-mask"></div><main class="page" data-v-f058c2ee><div class="container" data-v-f058c2ee><!--[--><!--]--><div style="position:relative;" class="content" data-v-f058c2ee><div><div class="language-js"><pre><code>
# log4js包用法

## configuration对象
log4js<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span>object <span class="token operator">||</span> string<span class="token punctuation">)</span> ：配置 log4js。

<span class="token operator">**</span>string<span class="token operator">**</span>：加载配置的文件名。配置文件必须是 <span class="token constant">JSON</span> 文件，并包含一个配置对象（参见下面的格式）。

<span class="token operator">**</span>object<span class="token operator">**</span>：直接传递一个configuration对象
在应用程序中首次 <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;log4js&#39;</span><span class="token punctuation">)</span> 之后，应该立即进行配置。如果不调用 configure，log4js 将使用 <span class="token constant">LOG4JS_CONFIG</span> （如果已定义）或默认配置。默认的配置定义了一个 appender，使用带颜色的布局将日志记录到 stdout，但也定义了默认日志级别是关闭的（即不会输出日志）。

如果您使用的是 cluster，那么在工作进程及主进程中都会调用 configure。工作进程将会为您的类别选择正确的级别，以及选择您定义的任何自定义级别。Appenders 只会在主进程被定义。因此，不存在多个进程试图写入同一个 appender 的危险。不需要特殊的配置来使用带有 cluster 的 Log4js （与以前的版本不同）。

<span class="token operator">**</span>configuration<span class="token operator">**</span> 对象必须定义至少一个 appender 和一个默认类别。如果配置无效，Log4js 将抛出异常。

<span class="token operator">**</span>configure<span class="token operator">**</span> 方法调用返回已配置的 Log4js 对象。

## Configuration 对象
<span class="token literal-property property">Properties</span><span class="token operator">:</span>

<span class="token operator">**</span>levels<span class="token operator">**</span> <span class="token punctuation">(</span>可选<span class="token punctuation">,</span> object<span class="token punctuation">)</span>： 用于定义定制日志级别，或重新定义现有日志级别。是一个 map，key 是级别名level name（string<span class="token punctuation">,</span> 不区分大小写），value是一个object对象。
object对象有两个属性：level value级别（整数）以及 colour颜色。

日志级别用于分配日志消息的重要性，使用整数值来对其进行排序。如果您没有在配置中指定任何内容，则使用默认值：

<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ALL &lt; TRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATAL &lt; MARK &lt; OFF</span><span class="token template-punctuation string">`</span></span>

<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">（OFF是用来关闭日志记录的，不是日志记录的一个级别。如果使用了 OFF，则不需要调用 logger.off(&#39;some log message&#39;)来关闭日志。）
这里定义的级别除了默认级别外，还可以用整数值来确定它们与默认级别的关系。
如果您定义的级别与默认级别相同，那么 config 中的整数值是优先级更高的。

级别的名称必须以字母开头，并且只能包含字母、数字和下划线。

appenders (object)：将命名 appender（string）映射到 appender definitions （object）的 map。appender definitions 必须有一个属性 type（string），其他属性依赖于 appender type。

categories (object)：将命名 categories （string）映射到 category definitions（object）。你需要定义默认类别 category 用于所有与特定类别不匹配的日志事件。

类别定义 category definitions 有两个属性：
appenders (array of strings)：在这个 category 类别中使用的 appender 名称列表。一个 category 类别中至少要有一个 appender

level (string, 不区分大小写)：这个 category 类别将给 appender 发送最小的日志级别。例如：如果设置成“error”，那么 appender 将只会收到级别为‘error’, ‘fatal’, ‘mark’的日志事件，日志事件为‘info’, ‘warn’, ‘debug’, ‘trace’的将会被忽略。
pm2 (可选, boolean)：
若您的 app 使用了 pm2，则这里必须设置为true，否则日志将不会工作（另外您还得下载 pm2-intercom作为 pm2模块: pm2 install pm2-intercom）
pm2InstanceVar (string, 可选) (默认 ‘NODE_APP_INSTANCE’)：如果您使用pm2并更改了默认名称，则这里必须要设置。
disableClustering (boolean, 可选)：
true：使用的 log4js 忽略集群环境（clustered environments）或者你在 pm2 日志中遇到了麻烦。每一个工作进程都将进行自己的日志记录。请小心使用这里如果你要把日志记录输出到文件。</span><span class="token template-punctuation string">`</span></span>
## Loggers
log4js<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token punctuation">[</span>category<span class="token punctuation">]</span><span class="token punctuation">)</span> ：

此函数接受一个可选的字符串参数，以表示要在这个记录器上使用日志事件的类别。如果没有指定类别，则事件将被路由到默认类别的 appender 上。
返回一个 Logger 对象，它的级别设置为 config 中指定的级别，并实现下列功能：
<span class="token operator">&lt;</span>level<span class="token operator">&gt;</span><span class="token punctuation">(</span>args<span class="token operator">...</span><span class="token punctuation">)</span>：可以是任何级别的小写名称（包括定义的任何定制级别）。例如：logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&#39;some info&#39;</span><span class="token punctuation">)</span>将用信息级别发送一个日志事件。如果您使用的是基本的、彩色的或通过布局传递的消息，那么日志字符串将会委托给util<span class="token punctuation">.</span>format来定义格式（占位符，如<span class="token operator">%</span>s、<span class="token operator">%</span>d等）。
is<span class="token operator">&lt;</span>level<span class="token operator">&gt;</span><span class="token function">Enabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：如果一个 level（驼峰命名） 级别的日志事件将被发送到为 logger 类别定义的 appender 上，则返回<span class="token boolean">true</span>。例如：logger<span class="token punctuation">.</span><span class="token function">isInfoEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span>将返回 <span class="token boolean">true</span>如果事件的级别是 
<span class="token constant">INFO</span>或者低于<span class="token constant">INFO</span>。

<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">addContext(&lt;key&gt;,&lt;value&gt;)：&lt;key&gt;是一个字符串，
&lt;value&gt;可以是任意类型。这会存储一个键-值对，它被会添加到 appender 生成的所有日志事件中。</span><span class="token template-punctuation string">`</span></span>

用途：通过您的应用程序添加用于跟踪用户的 id。目前，只有 logFaces appender才会使用上下文值。
<span class="token function">removeContext</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>key<span class="token operator">&gt;</span><span class="token punctuation">)</span>：从上下文删除先前定义的键值对。
<span class="token function">clearContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>：从 appender 中删除所有上下文对。
## Logger对象
<span class="token literal-property property">Properties</span><span class="token operator">:</span>

level：log4js 级别或一个与级别（‘info’<span class="token punctuation">,</span> ‘<span class="token constant">INFO</span>’）匹配的字符串。允许覆盖这个日志的配置级别。改变这个值适用于同一类别的所有日志记录。

## Shutdown

log4js<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span>：
接受一个回调，当 log4js 关闭所有 appender 并完成写日志事件时，它将被调用。当您的程序退出时，请使用此函数来确保所有的日志都被写入文件，套接字被关闭，等等。
</code></pre></div></div></div><footer class="page-footer" data-v-f058c2ee data-v-4d1950e8><div class="edit" data-v-4d1950e8><div class="edit-link" data-v-4d1950e8 data-v-d1f281aa><!----></div></div><div class="updated" data-v-4d1950e8><p class="last-updated" data-v-4d1950e8 data-v-01ad1c9a><span class="prefix" data-v-01ad1c9a>最近更新时间:</span><span class="datetime" data-v-01ad1c9a></span></p></div></footer><!----><!--[--><!--]--></div></main></div><!----><!--]--></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"ideshortcutkey_webstorm.md\":\"18c6c91e\",\"about_index.md\":\"266d606d\",\"client_electron_base.md\":\"73b81831\",\"client_electron_index.md\":\"63ff8f07\",\"client_typescript_index.md\":\"2609fcb2\",\"client_css_滚动条.md\":\"704dd147\",\"client_javascript_xmlhttprequest.md\":\"ea195791\",\"client_javascript_base.md\":\"fd1f6794\",\"client_javascript_index.md\":\"eece4482\",\"client_javascript_函数.md\":\"bf6b65b9\",\"concat_index.md\":\"a782833f\",\"environmentconstruction_index.md\":\"b7b45d45\",\"environmentconstruction_linux.md\":\"491489b6\",\"environmentconstruction_mongodb离线安装.md\":\"9d0f7670\",\"environmentconstruction_mysql离线安装.md\":\"a3088b54\",\"environmentconstruction_nginx.md\":\"f2832f95\",\"environmentconstruction_redis离线安装.md\":\"29fa9b75\",\"home_home.md\":\"38f1fc65\",\"index.md\":\"b65b705c\",\"interest_drug_index.md\":\"90a8b05a\",\"interest_music_index.md\":\"3981382e\",\"npmpackage_index.md\":\"93ce991e\",\"npmpackage_log4js.md\":\"6d781e35\",\"qdcz-note.md\":\"4557beaf\",\"service_linux_index.md\":\"a9464d28\",\"service_linux_linux.md\":\"4e8c9496\",\"service_linux_存储单位.md\":\"1e89b4f1\",\"service_mongodb_base.md\":\"6ca155d3\",\"service_mongodb_index.md\":\"4208220d\",\"service_mongodb_建立ttl索引.md\":\"53de734b\",\"service_nginx_index.md\":\"11980c9c\",\"service_nginx_window版本.md\":\"fe4f4779\",\"service_nodejs_base.md\":\"adf20931\",\"service_nodejs_buffer.md\":\"31afcf78\",\"service_nodejs_index.md\":\"bc3250b8\",\"service_nodejs_process.md\":\"ee6d3833\",\"service_nodejs_stream.md\":\"18fec455\",\"service_nodejs_工具函数.md\":\"0a5d610f\",\"service_nodejs_文件描述符.md\":\"d3c6d470\",\"service_nodejs_日志系统记录.md\":\"6aca9a07\",\"service_nodejs_混淆编译打包.md\":\"33ae689f\",\"service_nodejs_锁.md\":\"6d1431a0\",\"service_koa_index.md\":\"8c028d04\",\"service_koa_洋葱模型.md\":\"26a07483\",\"softwareengineering_面向对象编程.md\":\"7d674901\",\"temporary_index.md\":\"5a23302e\",\"temporary_recentplan.md\":\"4a33a5c9\",\"temporary_websocketforauthbynodejs.md\":\"2ff12679\",\"temporary_work_day_work_report.md\":\"b2cedae0\",\"temporary_work_todayplan.md\":\"b7eb1c2b\",\"temporary_work_weekly_work_report.md\":\"26f025a0\",\"windowsystem_index.md\":\"3bc40c62\",\"windowsystem_创建本地共享文件夹.md\":\"76d9012b\"}")</script>
    <script type="module" async src="/assets/app.f3070ad9.js"></script>
    
  </body>
</html>